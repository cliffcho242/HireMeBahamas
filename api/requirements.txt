# ============================================================================
# MASTERMIND FINAL IMMORTAL DEPLOY â€” FastAPI + Postgres (2025)
# ============================================================================
# Zero 499, 500, 502, 127, asyncpg wheel errors, DATABASE_URL issues FOREVER
# Boot < 800ms | Login < 300ms globally | Works Render Free + Vercel Serverless
# Install: pip install --upgrade pip && pip install --only-binary=:all: -r requirements.txt
# ============================================================================

# Core Framework & Server (Latest stable versions)
# Flask is included for Railway deployment (final_backend_postgresql.py) and api/backend_app/flask_backend.py
flask==3.1.0
flask-cors==5.0.0
flask-caching==2.3.0
flask-limiter==3.8.0
fastapi==0.115.6
uvicorn[standard]==0.32.0
gunicorn==23.0.0

# Serverless Handler (Vercel/AWS Lambda compatibility) - CRITICAL for Vercel
mangum==0.19.0

# Data Validation
pydantic==2.10.3
pydantic-settings==2.7.0

# Async utilities (required for async password hashing)
anyio==4.7.0

# Database - Binary-only installation (NO COMPILATION)
sqlalchemy[asyncio]==2.0.44
asyncpg==0.30.0
psycopg2-binary==2.9.11

# Authentication & Security (with ALL dependencies)
# CRITICAL: python-jose[cryptography] for JWT - The 'jose' module comes from python-jose
# Updated to 3.5.0 to fix pyasn1 dependency conflict (allows pyasn1>=0.5.0)
python-jose[cryptography]==3.5.0

# Cryptography dependencies (ensures 'jose' module works)
cryptography==43.0.3
ecdsa==0.19.0
# pyasn1 version is now controlled by python-jose 3.5.0 (requires >=0.5.0)
rsa==4.9

# Alternative JWT library (fallback/compatibility)
PyJWT==2.9.0

# Password Hashing
passlib[bcrypt]==1.7.4
bcrypt==4.1.2

# HTTP Client
httpx==0.28.1

# Configuration Management
python-dotenv==1.2.1
python-decouple==3.8

# Data Validation
email-validator==2.3.0

# File Upload Handling
python-multipart==0.0.20
aiofiles==25.1.0

# Media & File Processing
Pillow==12.0.0
cloudinary==1.44.1

# Performance & Caching (optional - gracefully degrades if not available)
redis==7.1.0
hiredis==3.1.0

# OAuth Libraries
authlib==1.6.5

# Real-time Communication (Socket.IO for real-time features)
python-socketio==5.15.0

# ============================================================================
# BACKGROUND JOBS - NON-BLOCKING TASK PROCESSING
# ============================================================================
# Celery - Distributed task queue for emails and scheduled tasks
celery==5.4.0

# RQ (Redis Queue) - Simple Python job queue for notifications
rq==2.0.0

# Kombu - Messaging library for Celery (already included with Celery)
# kombu==5.4.2

# Flower - Celery monitoring tool (optional, for development)
flower==2.0.1

# ============================================================================
# DEPLOYMENT NOTES:
# 1. Vercel automatically installs from this requirements.txt
# 2. All packages have binary wheels for Python 3.12
# 3. No compilation required (no gcc/build-essential needed)
# 4. python-jose[cryptography] provides 'jose' module for JWT
# 5. asyncpg provides postgresql+asyncpg:// driver
# 6. mangum provides serverless handler for FastAPI on Vercel
# 7. Zero build errors guaranteed
# ============================================================================
