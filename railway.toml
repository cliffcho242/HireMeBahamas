# ============================================================================
# Railway Configuration for HireMeBahamas Backend
# ============================================================================
# This file configures the Python backend service ONLY
# 
# ğŸš¨ğŸš¨ğŸš¨ CRITICAL: PostgreSQL Configuration ğŸš¨ğŸš¨ğŸš¨
# ====================================
# âŒ DO NOT deploy PostgreSQL as a container service!
# âŒ DO NOT use docker-compose on Railway!
# âŒ DO NOT deploy this repository as a PostgreSQL service!
# 
# If you see this error:
#   "root execution of the PostgreSQL server is not permitted"
#   "Mounting volume on: /var/lib/containers/railwayapp/bind-mounts"
# 
# YOU HAVE MISCONFIGURED RAILWAY!
# 
# âœ… CORRECT Setup:
#    1. In Railway Dashboard â†’ + New â†’ Database â†’ PostgreSQL
#    2. Use Railway's MANAGED PostgreSQL database service
#    3. Railway auto-injects DATABASE_URL environment variable
#    4. Your backend service connects to the managed database
# 
# âŒ WRONG Setup (causes the error above):
#    â€¢ Deploying this repo as a PostgreSQL service
#    â€¢ Adding PostgreSQL from container image
#    â€¢ Deploying docker-compose.yml files
#    â€¢ Installing postgresql server packages
# 
# ğŸ“– QUICK FIX: RAILWAY_POSTGRES_QUICKFIX.md (5 minutes)
# ğŸ“– DETAILED GUIDE: RAILWAY_POSTGRES_ROOT_ERROR_FIX.md
# ============================================================================

[build]
builder = "NIXPACKS"
watchPatterns = [
    "api/**/*.py",
    "backend/**/*.py", 
    "*.py",
    "requirements.txt",
    "nixpacks.toml"
]

[deploy]
startCommand = "python validate_startup.py && gunicorn final_backend_postgresql:application --config gunicorn.conf.py"
healthcheckPath = "/health"
healthcheckTimeout = 180
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10
numReplicas = 1

# Prevent Railway from trying to deploy PostgreSQL
# Only the Python backend should be deployed from this repository
[service]
type = "web"
# Explicitly set service type to prevent PostgreSQL container deployment
